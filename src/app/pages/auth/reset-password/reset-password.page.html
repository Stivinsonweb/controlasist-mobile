<ion-content [fullscreen]="true">
  <div class="reset-container">
    
    <!-- Header con icono -->
    <div class="header-section">
      <div class="logo-container">
        <ion-icon name="lock-closed" class="logo-icon"></ion-icon>
      </div>
      <h1 class="app-title">Nueva Contraseña</h1>
      <p class="app-subtitle">Crea una contraseña segura para tu cuenta</p>
    </div>

    <!-- Formulario -->
    <div class="form-container">
      <ion-card class="reset-card">
        <ion-card-content>
          
          <!-- Título del formulario -->
          <div class="form-header">
            <h2 class="form-title">Restablecer Contraseña</h2>
            <p class="form-subtitle">Ingresa tu nueva contraseña</p>
          </div>

          <form [formGroup]="resetForm" (ngSubmit)="resetPassword()">
            
            <!-- Nueva Contraseña -->
            <div class="input-group">
              <ion-label class="input-label">
                <ion-icon name="lock-closed-outline" class="label-icon"></ion-icon>
                Nueva Contraseña
              </ion-label>
              <ion-item lines="none" class="custom-item" [class.item-error]="password?.invalid && password?.touched">
                <ion-input 
                  [type]="showPassword ? 'text' : 'password'"
                  formControlName="password"
                  placeholder="Mínimo 8 caracteres"
                  class="custom-input">
                  <ion-icon name="lock-closed" slot="start" class="input-icon"></ion-icon>
                  <ion-icon 
                    [name]="showPassword ? 'eye-off' : 'eye'" 
                    slot="end" 
                    class="toggle-password"
                    (click)="togglePassword()">
                  </ion-icon>
                </ion-input>
              </ion-item>
              <div class="error-message" *ngIf="password?.invalid && password?.touched">
                <ion-icon name="alert-circle" class="error-icon"></ion-icon>
                <span>{{ password?.hasError('required') ? 'La contraseña es requerida' : 'Mínimo 8 caracteres' }}</span>
              </div>
            </div>

            <!-- Confirmar Contraseña -->
            <div class="input-group">
              <ion-label class="input-label">
                <ion-icon name="checkmark-circle-outline" class="label-icon"></ion-icon>
                Confirmar Contraseña
              </ion-label>
              <ion-item lines="none" class="custom-item" [class.item-error]="(confirmPassword?.invalid || resetForm.hasError('passwordMismatch')) && confirmPassword?.touched">
                <ion-input 
                  [type]="showConfirmPassword ? 'text' : 'password'"
                  formControlName="confirmPassword"
                  placeholder="Repite la contraseña"
                  class="custom-input">
                  <ion-icon name="checkmark-circle" slot="start" class="input-icon"></ion-icon>
                  <ion-icon 
                    [name]="showConfirmPassword ? 'eye-off' : 'eye'" 
                    slot="end" 
                    class="toggle-password"
                    (click)="toggleConfirmPassword()">
                  </ion-icon>
                </ion-input>
              </ion-item>
              <div class="error-message" *ngIf="confirmPassword?.touched && resetForm.hasError('passwordMismatch')">
                <ion-icon name="alert-circle" class="error-icon"></ion-icon>
                <span>Las contraseñas no coinciden</span>
              </div>
            </div>

            <!-- Recomendaciones -->
            <div class="info-box">
              <h4>
                <ion-icon name="information-circle" class="info-icon"></ion-icon>
                Tu contraseña debe contener:
              </h4>
              <ul>
                <li [class.valid]="password?.value?.length >= 8">
                  <ion-icon [name]="password?.value?.length >= 8 ? 'checkmark-circle' : 'ellipse-outline'"></ion-icon>
                  Al menos 8 caracteres
                </li>
                <li [class.valid]="hasUpperCase(password?.value)">
                  <ion-icon [name]="hasUpperCase(password?.value) ? 'checkmark-circle' : 'ellipse-outline'"></ion-icon>
                  Una letra mayúscula
                </li>
                <li [class.valid]="hasLowerCase(password?.value)">
                  <ion-icon [name]="hasLowerCase(password?.value) ? 'checkmark-circle' : 'ellipse-outline'"></ion-icon>
                  Una letra minúscula
                </li>
                <li [class.valid]="hasNumber(password?.value)">
                  <ion-icon [name]="hasNumber(password?.value) ? 'checkmark-circle' : 'ellipse-outline'"></ion-icon>
                  Un número
                </li>
              </ul>
            </div>

            <!-- Botón -->
            <ion-button 
              expand="block" 
              type="submit"
              [disabled]="resetForm.invalid"
              class="reset-button">
              <ion-icon name="checkmark-done-outline" slot="start"></ion-icon>
              Actualizar Contraseña
            </ion-button>

            <!-- Volver al login -->
            <div class="back-to-login">
              <a [routerLink]="['/auth/login']" class="back-link">
                <ion-icon name="arrow-back-outline"></ion-icon>
                Volver al inicio de sesión
              </a>
            </div>

          </form>
        </ion-card-content>
      </ion-card>
    </div>

    <!-- Footer -->
    <div class="footer-section">
      <p class="footer-text">
        <ion-icon name="shield-checkmark" class="footer-icon"></ion-icon>
        Conexión segura y cifrada
      </p>
    </div>
  </div>
</ion-content>
"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[966],{9966:(k,_,g)=>{g.d(_,{LoginPage:()=>w});var p=g(467),f=g(9769),l=g(5206),c=g(8370),h=g(2951),d=g(5873),e=g(5547),b=g(9758),x=g(1339);function C(a,m){if(1&a&&(e.j41(0,"div",38),e.nrm(1,"ion-icon",39),e.j41(2,"span"),e.EFF(3),e.k0s()()),2&a){const n=e.XpG();e.R7$(3),e.JRh(null!=n.email&&n.email.hasError("required")?"El correo es requerido":"Formato de correo inv\xe1lido")}}function P(a,m){if(1&a&&(e.j41(0,"div",38),e.nrm(1,"ion-icon",39),e.j41(2,"span"),e.EFF(3),e.k0s()()),2&a){const n=e.XpG();e.R7$(3),e.JRh(null!=n.password&&n.password.hasError("required")?"La contrase\xf1a es requerida":"M\xednimo 6 caracteres")}}function O(a,m){1&a&&e.nrm(0,"ion-icon",40)}function M(a,m){1&a&&e.nrm(0,"ion-spinner",41)}let w=(()=>{class a{constructor(n,t,o,r,i,s){this.formBuilder=n,this.router=t,this.authService=o,this.alertController=r,this.loadingController=i,this.toastController=s,this.isLoading=!1,this.showPassword=!1,(0,h.d)({peopleCircleOutline:d.szM,mailOutline:d.SM1,mail:d.kiB,lockClosedOutline:d.eso,lockClosed:d.AaQ,eye:d.y5U,eyeOff:d.zsm,checkmarkDoneOutline:d.u8Q,personAddOutline:d.zsU,shieldCheckmark:d.hEE,alertCircle:d.nVl})}ngOnInit(){this.initForm()}initForm(){this.loginForm=this.formBuilder.group({email:["",[l.k0.required,l.k0.email]],password:["",[l.k0.required,l.k0.minLength(6)]]})}togglePassword(){this.showPassword=!this.showPassword}login(){var n=this;return(0,p.A)(function*(){if(n.loginForm.valid){const t=yield n.loadingController.create({message:"Iniciando sesi\xf3n...",spinner:"crescent",cssClass:"custom-loading"});yield t.present();try{const{email:o,password:r}=n.loginForm.value,i=yield n.authService.login({email:o,password:r});if(yield t.dismiss(),i.success&&i.profile){const s=i.profile.nombres||"Usuario",u=i.profile.rol;console.log("\u2705 Login exitoso. Rol:",u),yield n.showToast(`\xa1Bienvenido ${s}!`,"success"),"administrador"===u?(console.log("\u{1f504} Redirigiendo a /admin/dashboard"),n.router.navigate(["/admin/dashboard"])):"docente"===u?(console.log("\u{1f504} Redirigiendo a /home"),n.router.navigate(["/home"])):(console.warn("\u26a0\ufe0f Rol desconocido:",u),n.router.navigate(["/home"]))}else{let s="Credenciales inv\xe1lidas";s=i.error?.includes("Invalid login credentials")?"Correo o contrase\xf1a incorrectos. Verifica tus datos.":i.error?.includes("Email not confirmed")?"Debes confirmar tu correo electr\xf3nico antes de iniciar sesi\xf3n.":i.error?.includes("Usuario no encontrado")?"Tu cuenta no est\xe1 registrada correctamente en el sistema.":i.error||"Error al iniciar sesi\xf3n",yield n.showAlert("Error de autenticaci\xf3n",s)}}catch(o){yield t.dismiss(),yield n.showAlert("Error",o.message||"Error inesperado al iniciar sesi\xf3n")}}else n.email?.hasError("required")?yield n.showToast("El correo electr\xf3nico es requerido","warning"):n.email?.hasError("email")?yield n.showToast("Ingresa un correo electr\xf3nico v\xe1lido","warning"):n.password?.hasError("required")?yield n.showToast("La contrase\xf1a es requerida","warning"):n.password?.hasError("minlength")&&(yield n.showToast("La contrase\xf1a debe tener al menos 6 caracteres","warning"))})()}forgotPassword(){var n=this;return(0,p.A)(function*(){const t=yield n.alertController.create({header:"Recuperar contrase\xf1a",message:"Ingresa tu correo electr\xf3nico registrado para recibir un enlace de recuperaci\xf3n.",inputs:[{name:"email",type:"email",placeholder:"correo@ejemplo.com",attributes:{autocomplete:"email",inputmode:"email"}}],buttons:[{text:"Cancelar",role:"cancel",cssClass:"alert-button-cancel"},{text:"Enviar",cssClass:"alert-button-confirm",handler:(o=(0,p.A)(function*(r){if(!r.email)return yield n.showToast("Por favor ingresa un correo electr\xf3nico","warning"),!1;if(!n.isValidEmail(r.email))return yield n.showToast("Por favor ingresa un correo v\xe1lido","warning"),!1;yield t.dismiss();const i=yield n.loadingController.create({message:"Verificando correo...",spinner:"crescent"});yield i.present();const s=yield n.authService.forgotPassword(r.email);return yield i.dismiss(),s.success?yield n.showSuccessAlert("\u2713 Correo enviado",s.message||"Hemos enviado un enlace de recuperaci\xf3n a tu correo electr\xf3nico. Revisa tu bandeja de entrada y carpeta de spam."):yield n.showAlert("Error",s.error||"No se pudo enviar el correo de recuperaci\xf3n. Verifica que el correo est\xe9 registrado."),!1}),function(i){return o.apply(this,arguments)})}],cssClass:"custom-alert"});var o;yield t.present()})()}goToRegister(){this.router.navigate(["/auth/register"])}showAlert(n,t){var o=this;return(0,p.A)(function*(){yield(yield o.alertController.create({header:n,message:t,buttons:["OK"],cssClass:"custom-alert"})).present()})()}showSuccessAlert(n,t){var o=this;return(0,p.A)(function*(){yield(yield o.alertController.create({header:n,message:t,buttons:[{text:"Entendido",role:"confirm"}],cssClass:"custom-alert success-alert"})).present()})()}showToast(n){var t=this;return(0,p.A)(function*(o,r="success"){yield(yield t.toastController.create({message:o,duration:3e3,position:"top",color:r,cssClass:"custom-toast"})).present()}).apply(this,arguments)}isValidEmail(n){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(n)}get email(){return this.loginForm.get("email")}get password(){return this.loginForm.get("password")}static{this.\u0275fac=function(t){return new(t||a)(e.rXU(l.ok),e.rXU(b.Ix),e.rXU(x.u),e.rXU(c.hG),e.rXU(c.Xi),e.rXU(c.K_))}}static{this.\u0275cmp=e.VBU({type:a,selectors:[["app-login"]],decls:55,vars:14,consts:[[3,"fullscreen"],[1,"login-container"],[1,"header-section"],[1,"logo-container"],["name","people-circle-outline",1,"logo-icon"],[1,"app-title"],[1,"app-subtitle"],[1,"form-container"],[1,"login-card"],[1,"form-header"],[1,"form-title"],[1,"form-subtitle"],[3,"ngSubmit","formGroup"],[1,"input-group"],[1,"input-label"],["name","mail-outline",1,"label-icon"],["lines","none",1,"custom-item"],["type","email","formControlName","email","placeholder","ejemplo@correo.com",1,"custom-input"],["name","mail","slot","start",1,"input-icon"],["class","error-message",4,"ngIf"],[1,"label-row"],["name","lock-closed-outline",1,"label-icon"],["formControlName","password","placeholder","Ingresa tu contrase\xf1a",1,"custom-input",3,"type"],["name","lock-closed","slot","start",1,"input-icon"],["slot","end",1,"toggle-password",3,"click","name"],[1,"forgot-password-container"],[1,"forgot-password-link",3,"click"],["name","key-outline",1,"forgot-icon"],["expand","block","type","submit",1,"login-button",3,"disabled"],["name","checkmark-done-outline","slot","start",4,"ngIf"],["name","crescent",4,"ngIf"],[1,"divider"],[1,"divider-text"],["expand","block","fill","outline",1,"register-button",3,"click"],["name","person-add-outline","slot","start"],[1,"footer-section"],[1,"footer-text"],["name","shield-checkmark",1,"footer-icon"],[1,"error-message"],["name","alert-circle",1,"error-icon"],["name","checkmark-done-outline","slot","start"],["name","crescent"]],template:function(t,o){1&t&&(e.j41(0,"ion-content",0)(1,"div",1)(2,"div",2)(3,"div",3),e.nrm(4,"ion-icon",4),e.k0s(),e.j41(5,"h1",5),e.EFF(6,"ControlAsist"),e.k0s(),e.j41(7,"p",6),e.EFF(8,"Sistema de Control de Asistencia Acad\xe9mica"),e.k0s()(),e.j41(9,"div",7)(10,"ion-card",8)(11,"ion-card-content")(12,"div",9)(13,"h2",10),e.EFF(14,"Iniciar Sesi\xf3n"),e.k0s(),e.j41(15,"p",11),e.EFF(16,"Accede a tu panel de control"),e.k0s()(),e.j41(17,"form",12),e.bIt("ngSubmit",function(){return o.login()}),e.j41(18,"div",13)(19,"ion-label",14),e.nrm(20,"ion-icon",15),e.EFF(21," Correo electr\xf3nico "),e.k0s(),e.j41(22,"ion-item",16)(23,"ion-input",17),e.nrm(24,"ion-icon",18),e.k0s()(),e.DNE(25,C,4,1,"div",19),e.k0s(),e.j41(26,"div",13)(27,"div",20)(28,"ion-label",14),e.nrm(29,"ion-icon",21),e.EFF(30," Contrase\xf1a "),e.k0s()(),e.j41(31,"ion-item",16)(32,"ion-input",22),e.nrm(33,"ion-icon",23),e.j41(34,"ion-icon",24),e.bIt("click",function(){return o.togglePassword()}),e.k0s()()(),e.DNE(35,P,4,1,"div",19),e.k0s(),e.j41(36,"div",25)(37,"a",26),e.bIt("click",function(){return o.forgotPassword()}),e.nrm(38,"ion-icon",27),e.EFF(39," \xbfOlvidaste tu contrase\xf1a? "),e.k0s()(),e.j41(40,"ion-button",28),e.DNE(41,O,1,0,"ion-icon",29)(42,M,1,0,"ion-spinner",30),e.j41(43,"span"),e.EFF(44),e.k0s()(),e.j41(45,"div",31)(46,"span",32),e.EFF(47,"\xbfNo tienes cuenta?"),e.k0s()(),e.j41(48,"ion-button",33),e.bIt("click",function(){return o.goToRegister()}),e.nrm(49,"ion-icon",34),e.EFF(50," Crear cuenta nueva "),e.k0s()()()()(),e.j41(51,"div",35)(52,"p",36),e.nrm(53,"ion-icon",37),e.EFF(54," Conexi\xf3n segura y cifrada "),e.k0s()()()()),2&t&&(e.Y8G("fullscreen",!0),e.R7$(17),e.Y8G("formGroup",o.loginForm),e.R7$(5),e.AVh("item-error",(null==o.email?null:o.email.invalid)&&(null==o.email?null:o.email.touched)),e.R7$(3),e.Y8G("ngIf",(null==o.email?null:o.email.invalid)&&(null==o.email?null:o.email.touched)),e.R7$(6),e.AVh("item-error",(null==o.password?null:o.password.invalid)&&(null==o.password?null:o.password.touched)),e.R7$(),e.Y8G("type",o.showPassword?"text":"password"),e.R7$(2),e.Y8G("name",o.showPassword?"eye-off":"eye"),e.R7$(),e.Y8G("ngIf",(null==o.password?null:o.password.invalid)&&(null==o.password?null:o.password.touched)),e.R7$(5),e.Y8G("disabled",o.loginForm.invalid||o.isLoading),e.R7$(),e.Y8G("ngIf",!o.isLoading),e.R7$(),e.Y8G("ngIf",o.isLoading),e.R7$(2),e.JRh(o.isLoading?"Iniciando sesi\xf3n...":"Iniciar sesi\xf3n"))},dependencies:[f.MD,f.bT,l.YN,l.qT,l.BC,l.cb,l.X1,l.j4,l.JD,c.W9,c.b_,c.I9,c.uz,c.he,c.$w,c.Jm,c.iq,c.w2],styles:['ion-content[_ngcontent-%COMP%]{--background: #f8fafc}.login-container[_ngcontent-%COMP%]{min-height:100vh;display:flex;flex-direction:column;padding:20px;background:linear-gradient(180deg,#f0f9ff,#e0f2fe,#f8fafc 50%,#fff)}.header-section[_ngcontent-%COMP%]{text-align:center;padding:40px 0 30px;animation:_ngcontent-%COMP%_fadeInDown .6s ease-out}.logo-container[_ngcontent-%COMP%]{width:100px;height:100px;margin:0 auto 24px;background:linear-gradient(135deg,#3b82f6,#2563eb);border-radius:24px;display:flex;align-items:center;justify-content:center;box-shadow:0 10px 40px #3b82f64d;border:3px solid rgba(255,255,255,.5);position:relative}.logo-container[_ngcontent-%COMP%]:before{content:"";position:absolute;inset:-3px;border-radius:24px;padding:3px;background:linear-gradient(135deg,#60a5fa,#3b82f6,#2563eb);-webkit-mask:linear-gradient(#fff 0 0) content-box,linear-gradient(#fff 0 0);-webkit-mask-composite:xor;mask-composite:exclude;opacity:.6}.logo-icon[_ngcontent-%COMP%]{font-size:64px;color:#fff;filter:drop-shadow(0 4px 8px rgba(0,0,0,.2))}.app-title[_ngcontent-%COMP%]{font-size:36px;font-weight:800;background:linear-gradient(135deg,#1e40af,#3b82f6);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;margin:0 0 8px;letter-spacing:-1px}.app-subtitle[_ngcontent-%COMP%]{font-size:14px;color:#64748b;margin:0;font-weight:500}.form-container[_ngcontent-%COMP%]{flex:1;display:flex;align-items:center;justify-content:center;animation:_ngcontent-%COMP%_fadeInUp .6s ease-out;padding:20px 0}.login-card[_ngcontent-%COMP%]{width:100%;max-width:480px;border-radius:24px;box-shadow:0 4px 6px #0000000d,0 10px 15px #0000001a;background:#fff;margin:0;border:1px solid rgba(226,232,240,.8)}ion-card-content[_ngcontent-%COMP%]{padding:40px 32px}.form-header[_ngcontent-%COMP%]{text-align:center;margin-bottom:32px}.form-title[_ngcontent-%COMP%]{font-size:26px;font-weight:700;color:#1e293b;margin:0 0 8px}.form-subtitle[_ngcontent-%COMP%]{font-size:14px;color:#64748b;margin:0}.input-group[_ngcontent-%COMP%]{margin-bottom:24px}.label-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px}.input-label[_ngcontent-%COMP%]{display:flex;align-items:center;font-size:14px;font-weight:600;color:#334155}.label-icon[_ngcontent-%COMP%]{font-size:18px;margin-right:8px;color:#3b82f6}.custom-item[_ngcontent-%COMP%]{--border-radius: 12px;--background: #f8fafc;--padding-start: 16px;--padding-end: 16px;border:2px solid #e2e8f0;transition:all .3s ease}.custom-item[_ngcontent-%COMP%]:focus-within{--background: white;border-color:#3b82f6;box-shadow:0 0 0 4px #3b82f61a}.custom-item.item-error[_ngcontent-%COMP%]{border-color:#ef4444;--background: #fef2f2}.custom-input[_ngcontent-%COMP%]{--padding-start: 0;font-size:15px}.input-icon[_ngcontent-%COMP%]{font-size:20px;color:#94a3b8;margin-right:12px}.toggle-password[_ngcontent-%COMP%]{font-size:22px;color:#64748b;cursor:pointer;transition:color .2s}.toggle-password[_ngcontent-%COMP%]:hover{color:#3b82f6}.error-message[_ngcontent-%COMP%]{display:flex;align-items:center;margin-top:8px;font-size:12px;color:#ef4444;animation:_ngcontent-%COMP%_shake .3s}.error-message[_ngcontent-%COMP%]   .error-icon[_ngcontent-%COMP%]{font-size:16px;margin-right:6px}.forgot-password-container[_ngcontent-%COMP%]{text-align:right;margin-top:-8px;margin-bottom:24px}.forgot-password-link[_ngcontent-%COMP%]{display:inline-flex;align-items:center;font-size:13px;color:#3b82f6;text-decoration:none;font-weight:600;cursor:pointer;transition:all .2s;padding:8px 12px;border-radius:8px;background:transparent}.forgot-password-link[_ngcontent-%COMP%]:hover{color:#2563eb;background:#eff6ff;transform:translate(-2px)}.forgot-password-link[_ngcontent-%COMP%]:active{transform:scale(.98)}.forgot-icon[_ngcontent-%COMP%]{font-size:16px;margin-right:6px}.login-button[_ngcontent-%COMP%]{--border-radius: 12px;--background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);--background-hover: linear-gradient(135deg, #2563eb 0%, #1e40af 100%);height:54px;font-weight:600;text-transform:none;font-size:16px;margin-top:8px;box-shadow:0 4px 14px #3b82f666;transition:all .3s ease}.login-button[_ngcontent-%COMP%]:hover:not([disabled]){transform:translateY(-2px);box-shadow:0 8px 20px #3b82f680}.login-button[_ngcontent-%COMP%]:active:not([disabled]){transform:translateY(0)}.login-button[disabled][_ngcontent-%COMP%]{opacity:.6}.login-button[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:22px}.register-button[_ngcontent-%COMP%]{--border-radius: 12px;--border-color: #cbd5e1;--border-width: 2px;--color: #475569;height:54px;font-weight:600;text-transform:none;font-size:16px;margin-top:12px;transition:all .3s ease}.register-button[_ngcontent-%COMP%]:hover{--border-color: #3b82f6;--color: #3b82f6;--background: #eff6ff}.register-button[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:22px}.divider[_ngcontent-%COMP%]{position:relative;text-align:center;margin:32px 0 24px}.divider[_ngcontent-%COMP%]:before{content:"";position:absolute;left:0;top:50%;width:100%;height:1px;background:linear-gradient(90deg,transparent 0%,#e2e8f0 20%,#e2e8f0 80%,transparent 100%)}.divider-text[_ngcontent-%COMP%]{position:relative;display:inline-block;padding:0 20px;background:#fff;color:#94a3b8;font-size:13px;font-weight:500}.footer-section[_ngcontent-%COMP%]{text-align:center;padding:24px 0;animation:_ngcontent-%COMP%_fadeIn .6s ease-out .3s both}.footer-text[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;font-size:13px;color:#64748b;margin:0;font-weight:500}.footer-icon[_ngcontent-%COMP%]{font-size:18px;margin-right:8px;color:#10b981}@keyframes _ngcontent-%COMP%_fadeInDown{0%{opacity:0;transform:translateY(-20px)}to{opacity:1;transform:translateY(0)}}@keyframes _ngcontent-%COMP%_fadeInUp{0%{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0}to{opacity:1}}@keyframes _ngcontent-%COMP%_shake{0%,to{transform:translate(0)}25%{transform:translate(-5px)}75%{transform:translate(5px)}}@media(max-width:576px){.header-section[_ngcontent-%COMP%]{padding:30px 0 20px}.logo-container[_ngcontent-%COMP%]{width:90px;height:90px}.logo-icon[_ngcontent-%COMP%]{font-size:56px}.app-title[_ngcontent-%COMP%]{font-size:32px}.app-subtitle[_ngcontent-%COMP%]{font-size:13px}ion-card-content[_ngcontent-%COMP%]{padding:32px 24px}.form-title[_ngcontent-%COMP%]{font-size:24px}}[_nghost-%COMP%]     .custom-alert{--backdrop-opacity: .6}[_nghost-%COMP%]     .custom-alert .alert-wrapper{border-radius:20px;box-shadow:0 20px 60px #0000004d}[_nghost-%COMP%]     .custom-alert .alert-head{padding-bottom:12px}[_nghost-%COMP%]     .custom-alert .alert-head h2{color:#1e293b;font-weight:700}[_nghost-%COMP%]     .custom-alert .alert-message{color:#64748b;font-size:15px;line-height:1.6}[_nghost-%COMP%]     .custom-alert .alert-input{border:2px solid #e2e8f0;border-radius:10px;padding:14px;margin:12px 0;font-size:15px}[_nghost-%COMP%]     .custom-alert .alert-input:focus{border-color:#3b82f6;outline:none;box-shadow:0 0 0 4px #3b82f61a}[_nghost-%COMP%]     .custom-alert .alert-button-group{padding-top:16px}[_nghost-%COMP%]     .custom-alert .alert-button{font-weight:600;font-size:15px;text-transform:none}[_nghost-%COMP%]     .custom-alert .alert-button-cancel{color:#64748b}[_nghost-%COMP%]     .custom-alert .alert-button-confirm{color:#3b82f6}[_nghost-%COMP%]     .success-alert .alert-head h2{color:#10b981}[_nghost-%COMP%]     .custom-toast{--border-radius: 12px;--box-shadow: 0 8px 20px rgba(0, 0, 0, .15);font-weight:500}[_nghost-%COMP%]     .custom-loading{--backdrop-opacity: .7}[_nghost-%COMP%]     .custom-loading .loading-wrapper{border-radius:16px}']})}}return a})()}}]);